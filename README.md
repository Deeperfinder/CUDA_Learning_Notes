# CUDA_Learning_Notes
包含GEMM， FLash Attention的cute、cuda实现
## GEMM
- 目前在SM80上实现了Cute的简单GEMM  + 流水线GEMM（multi-stage）
* 通过python biding和torch load 来构建算子的benchmark

CUDA test 1 (naive / sliced k / cute)
```bash
----------------------------------------------------------------------------------------------------
---------------------------------------M=1024, N=1024, K=512----------------------------------------
                      naive_fp16: ['-12.4375  ', '0.0       '], time:0.0004328706141175895ms, TFLOPS:2.48  (+0.00%)
                   sliced_k_fp16: ['41.03125  ', '-3.1835937'], time:0.0002720706252188518ms, TFLOPS:3.95  (+59.10%)
   tn(cute+stage4+swizzle<smem>): ['11.4140625', '0.15649414'], time:3.484799956967091e-05ms, TFLOPS:30.81 (+680.74%)
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------M=2048, N=2048, K=1024---------------------------------------
                      naive_fp16: ['16.75     ', '0.0       '], time:0.0019279084082307488ms, TFLOPS:4.46  (+0.00%)
   tn(cute+stage4+swizzle<smem>): ['-9.8671875', '33.625    '], time:0.00020125682960296505ms, TFLOPS:42.68 (+857.93%)
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------M=4096, N=4096, K=4096---------------------------------------
                      naive_fp16: ['45.15625  ', '5.28125   '], time:0.08954815042429959ms, TFLOPS:1.53  (+0.00%)
                   sliced_k_fp16: ['45.15625  ', '5.28125   '], time:0.04381607936990671ms, TFLOPS:3.14  (+104.37%)
   tn(cute+stage4+swizzle<smem>): ['-84.1875  ', '-61.46875 '], time:0.0031730879791851702ms, TFLOPS:43.31 (+1280.87%)
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------M=8192, N=8192, K=8192---------------------------------------
                      naive_fp16: ['122.1875  ', '70.25     '], time:0.7702831315665409ms, TFLOPS:1.43  (+0.00%)
                   sliced_k_fp16: ['122.1875  ', '70.25     '], time:0.3585295273353314ms, TFLOPS:3.07  (+114.85%)
   tn(cute+stage4+swizzle<smem>): ['-12.484375', '123.5     '], time:0.011755991212252917ms, TFLOPS:93.53 (+2949.76%)
----------------------------------------------------------------------------------------------------
```
